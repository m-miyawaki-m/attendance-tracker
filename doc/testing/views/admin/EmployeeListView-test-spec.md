# `EmployeeListView.vue` 単体テスト仕様書

## 1. 概要

| 項目 | 内容 |
|:---|:---|
| 対象ファイル | `src/views/admin/EmployeeListView.vue` |
| テストファイル | `tests/unit/views/admin/EmployeeListView.spec.ts` |
| 関連設計書 | [基本設計書 1.4.2](../../design/03-basic/03-basic-design.md#142-従業員管理画面-employeelistviewvue) |
| 設計書記載 | 従業員管理画面（対象月選択、従業員一覧表示、月次勤怠ステータス集計表示） |

## 2. テストの目的

`EmployeeListView.vue`コンポーネントが、従業員一覧と月次勤怠集計を正しく表示し、月選択機能が正しく動作することを保証する。

## 3. 使用するライブラリ

* **テストランナー**: Vitest
* **コンポーネントテスト**: Vue Test Utils
* **Firestore**: モック化されたFirestoreモジュール

## 4. テストケース

### 4.1. 初期表示

| テストID | テストケース | 期待する結果 |
| :--- | :--- | :--- |
| EL-001 | 月選択フィールド | 現在の年月が初期値として設定される（`YYYY-MM`形式）。 |
| EL-002 | ヘッダー表示 | 「従業員管理」タイトルが表示される。 |
| EL-003 | テーブルヘッダー | 社員番号、名前、役職、当月の出勤ステータス、備考のカラムが表示される。 |

### 4.2. データ取得

| テストID | テストケース | 期待する結果 |
| :--- | :--- | :--- |
| EL-004 | ユーザー取得 | マウント時に`users`コレクションからデータが取得される。 |
| EL-005 | 勤怠取得 | 選択月の開始日〜終了日で勤怠データが取得される。 |
| EL-006 | ローディング状態 | データ取得中は`loading`がtrue、完了後falseになる。 |

### 4.3. 月選択変更 (`watch selectedMonth`)

| テストID | テストケース | 操作 | 期待する結果 |
| :--- | :--- | :--- | :--- |
| EL-007 | 月変更時の再取得 | 月選択を変更 | `fetchAttendances`が呼び出され、新しい月のデータが取得される。 |
| EL-008 | 日付範囲計算 | 2026-01を選択 | `startDate: '2026-01-01'`、`endDate: '2026-01-31'`でクエリされる。 |

### 4.4. 従業員リスト計算 (`employeeList` computed)

| テストID | テストケース | 入力データ | 期待する結果 |
| :--- | :--- | :--- | :--- |
| EL-009 | 従業員フィルタリング | `role: 'employee'`のみ | `role: 'admin'`のユーザーは除外される。 |
| EL-010 | 勤怠ステータス集計 | ユーザーの月間勤怠 | `attendanceStatus`オブジェクトに各ステータスの件数が設定される。 |
| EL-011 | ステータス初期値 | 勤怠データなし | `{ present: 0, late: 0, early_leave: 0, absent: 0 }`が設定される。 |
| EL-012 | 社員番号表示 | `employeeNumber`がundefined | `'-'`が表示される。 |

### 4.5. テーブル表示

| テストID | テストケース | データ | 期待する結果 |
| :--- | :--- | :--- | :--- |
| EL-013 | 社員番号 | `employeeNumber: 'EMP001'` | `'EMP001'`が表示される。 |
| EL-014 | 名前 | `name: '山田太郎'` | `'山田太郎'`が表示される。 |
| EL-015 | 役職 | `position: '主任'` | `'主任'`が表示される。 |

### 4.6. ページネーション

| テストID | テストケース | 期待する結果 |
| :--- | :--- | :--- |
| EL-016 | デフォルト表示件数 | 1ページあたり10件が表示される。 |
| EL-017 | ページ切り替え | ページネーションが機能する。 |

## 5. 備考

- テストID（EL-001〜EL-017）はチェックリスト（PHASE2_TEST_CHECKLIST.md）と統一
- 実装テスト数: 17テスト関数
