# `LoginView.vue` 単体テスト仕様書

## 1. 概要

| 項目 | 内容 |
|:---|:---|
| 対象ファイル | `src/views/LoginView.vue` |
| 関連設計書 | [基本設計書 1.2.1](../../design/03-basic/03-basic-design.md#121-ログイン画面-loginviewvue) |
| 設計書記載 | ログイン画面（メールアドレス・パスワード入力、Firebase認証） |

## 2. テストの目的

`LoginView.vue`コンポーネントが、ログインフォームの入力・バリデーション、認証処理、ルーティング、スナックバー通知などの機能を正しく実装していることを保証する。

## 3. 使用するライブラリ

* **テストランナー**: Vitest
* **コンポーネントテスト**: Vue Test Utils
* **状態管理**: Pinia (テスト用にモック化)
* **ルーティング**: Vue Router (テスト用にモック化)

## 4. テストケース

### 4.1. 初期表示

| テストNo. | テストケース | 期待する結果 |
| :--- | :--- | :--- |
| 1-1 | フォーム要素表示 | メールアドレス入力欄、パスワード入力欄、ログインボタンが表示される。 |
| 1-2 | テストアカウントチップ表示 | 管理者、user01、user02、user03のテストアカウントチップが表示される。 |
| 1-3 | 初期値 | メールアドレス・パスワード欄が空、`rememberMe`がfalse。 |

### 4.2. テストアカウント入力 (`fillMockAccount`)

| テストNo. | テストケース | 操作 | 期待する結果 |
| :--- | :--- | :--- | :--- |
| 2-1 | 管理者アカウント選択 | 管理者チップをクリック | `email`が`'admin@example.com'`、`password`が`'adminadmin'`に設定される。スナックバーが表示される。 |
| 2-2 | user01アカウント選択 | user01チップをクリック | `email`が`'user01@example.com'`、`password`が`'user01'`に設定される。 |
| 2-3 | user02アカウント選択 | user02チップをクリック | `email`が`'user02@example.com'`、`password`が`'password123'`に設定される。 |

### 4.3. ログイン処理 (`handleLogin`)

| テストNo. | テストケース | ストアの動作 | 期待する結果 |
| :--- | :--- | :--- | :--- |
| 3-1 | ログイン成功（一般ユーザー） | `login`が`true`を返す、`isAdmin`が`false` | ・`loading`がtrueになりボタンがローディング状態になる。<br>・成功スナックバーが表示される。<br>・500ms後に`router.push('/')`が呼び出される。 |
| 3-2 | ログイン成功（管理者） | `login`が`true`を返す、`isAdmin`が`true` | ・500ms後に`router.push('/admin/dashboard')`が呼び出される。 |
| 3-3 | ログイン失敗（認証エラー） | `login`が`false`を返す | ・`router.push`が呼び出されない。<br>・エラースナックバー「メールアドレスまたはパスワードが正しくありません」が表示される。 |
| 3-4 | ログイン失敗（例外） | `login`が例外をスロー | ・`router.push`が呼び出されない。<br>・エラースナックバー「ログインに失敗しました」が表示される。 |
| 3-5 | ローディング状態 | ログイン処理中 | ・`loading`がtrueになる。<br>・ログインボタンがローディング状態になる。<br>・処理完了後`loading`がfalseに戻る。 |

### 4.4. パスワードリセット (`handlePasswordReset`)

| テストNo. | テストケース | 操作 | 期待する結果 |
| :--- | :--- | :--- | :--- |
| 4-1 | パスワードリセットボタン | 「パスワードをお忘れの方」をクリック | infoスナックバー「パスワードリセット機能はモックでは実装されていません」が表示される。 |

### 4.5. スナックバー表示 (`showSnackbar`)

| テストNo. | テストケース | 引数 | 期待する結果 |
| :--- | :--- | :--- | :--- |
| 5-1 | 成功メッセージ | `('ログインしました', 'success')` | 緑色のスナックバーにメッセージが表示される。 |
| 5-2 | エラーメッセージ | `('エラー', 'error')` | 赤色のスナックバーにメッセージが表示される。 |
| 5-3 | 情報メッセージ | `('情報', 'info')` | 青色のスナックバーにメッセージが表示される。 |
